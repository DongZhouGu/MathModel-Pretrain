# 一、因子分析简述
&emsp;&emsp;因子分析(factor analysis)是一种数据简化的技术。它通过研究众多变量之间的内部依赖关系，探求观测数据中的基本结构，并用少数几个假想变量来表示其基本的数据结构。这几个假想变量能够反映原来众多变量的主要信息。原始的变量是可观测的显 在变量，而假想变量是不可观测的潜在变量，称为因子。

&emsp;&emsp;因子分析与回归分析不同，因子分析中的因子是一个比较抽象的概念，而回归因子有非常明确的实际意义。

&emsp;&emsp;主成分分析分析与因子分析也有不同，主成分分析仅仅是变量变换，而因子分析需要构造因子模型。

&emsp;&emsp;**主成分分析**:原始变量的线性组合表示新的综合变量，即主成分。

&emsp;&emsp;**因子分析**：潜在的假想变量和随机影响变量的线性组合表示原始变量。 

# 二、因子分析模型
## 2.1 数学模型
![数学模型](./因子分析法1.png)
![因子分析法2](./因子分析法2.png)
## 2.2 因子分析模型的性质
### 2.2.1 原始变量 X 的协方差矩阵的分解 
![因子分析法3](./因子分析法3.png)
### 2.2.2 载荷矩阵不是唯一的
设 T 为一个$ p\times p $的正交矩阵，令 $ \large \tilde{A} =AT ,\tilde{F}=T^{T}F $,则模型可以表示为 $ \large X=\mu +\tilde{A}\tilde{F}+\varepsilon$
## 2.3 因子载荷矩阵中的几个统计性质
### 2.3.1 因子载荷 $\large a_{ij}$的统计意义
&emsp;&emsp;因子载荷 $\large a_{ij}$是第  $\large i$ 个变量与第 $\large j$个公共因子的相关系数，反映了第 i 个变量与第 j 个公共因子的相关重要性。绝对值越大，相关的密切程度越高。
### 2.3.2 变量共同度的统计意义  
&emsp;&emsp;变量$\large X_{i} $的共同度是因子载荷矩阵的第i行的元素的平方和，记为  $ \large h_{i}^{2}=\sum_{j=1}^{m}a_{ij}^{2} $
,对（49）式两边求方差，得
![因子分析法4](./因子分析法4.png)
&emsp;&emsp;可以看出所有的公共因子和特殊因子对变量 $\large X_{i}$ 的贡献为1。如果$\large \sum_{j=1}^{m}a_{ij}^{2}$ 非常靠近1，$\large \sigma _{i}^{2}$非常小，则因子分析的效果好，从原变量空间到公共因子空间的转化效果好。
### 2.3.3 公共因子$\large F_{j}$方差贡献的统计意义
&emsp;&emsp;因子载荷矩阵中各列元素的平方和$\large S_{j}=\sum_{i=1}^{p}a_{ij}^{2}$ 称为$\large F_{j} \left ( j=1,2,...,m \right )$ 对所有的$\large X_{i}$的方差贡献和，衡量$\large F_{j}$的相对重要性。
# 三、因子分析步骤
## 3.1 选择分析的变量
&emsp;&emsp;用定性分析和定量分析的方法选择变量，因子分析的前提条件是观测变量间有较强的相关性，因为如果变量之间无相关性或相关性较小的话，他们不会有共享因子,所以原始变量间应该有较强的相关性，一般通过Bartlett's球状检验和Kaiser-Meyer-Olkin检验来判断这些变量适不适合做因子分析。
## 3.2 对变量进行标准化处理
![因子分析法5](./因子分析法5.png)
## 3.3 计算所选原始变量的相关系数矩阵R
&emsp;&emsp;相关系数矩阵描述了原始变量之间的相关关系。可以帮助判断原始变量之间是否存在相关关系，这对因子分析是非常重要的，因为如果所选变量之间无关系，做因子分析是不恰当的。并且相关系数矩阵是估计因子结构的基础。
![因子分析法6](./因子分析法6.png)
## 3.5 计算初等载荷矩阵
![因子分析法7](./因子分析法7.png)
## 3.4 提出公共因子
&emsp;&emsp;这一步要确定因子求解的方法和因子的个数。需要根据研究者的设计方案或有关的经验或知识事先确定,这里我采用的是碎石图来确定因子个数。因子个数的确定可以根据因子方差的大小。只取方差大于1(或特征值大于1)的那些因子，因为方差小于1的因子其贡献可能很小；按照因子的累计方差贡献率来确定，一般认为要达到60％才能符合要求。
## 3.5 因子旋转
&emsp;&emsp;通过坐标变换使每个原始变量在尽可能少的因子之间有密切的关系，这样因子解的实际意义更容易解释,并为每个潜在因子赋予有实际意义的名字。  
&emsp;&emsp;根据初等载荷矩阵，计算各个公共因子的贡献率，并选择m 个主因子。对提取的因子载荷矩阵进行旋转，得到矩阵$B=\hat{A}T$ (其中$\hat{A}$为A的前m列，T为正交矩阵），构造因子模型
        $\left\{\begin{matrix} \tilde{x_{1}}=b_{11}F_{1}+\cdots +b_{1m}F_{m} \\ \cdots \cdots \cdots \cdots \cdots \cdots\cdots \cdots\\ \tilde{x_{p}}=b_{p1}F_{1}+\cdots +b_{pm}F_{m} \end{matrix}\right.$
## 3.6 计算因子得分
&emsp;&emsp;求出各样本的因子得分，有了因子得分值，则可以在许多分析中使用这些因子，例如以因子的得分做聚类分析的变量，做回归分析中的回归因子。
# 四、 因子分析和主成分分析的异同
## 4.1 相同点
&emsp;&emsp;在以下几方面是相同的：

&emsp;&emsp;1.1  指标的标准化，

&emsp;&emsp;1.2  相关系数矩阵及其特征值和特征向量，

&emsp;&emsp;1.3  用累计贡献率确定主成分、因子个数m ，

&emsp;&emsp;1.4  单个主成分与综合主成分的分析评价、单因子 与综合因子的分析评价步骤。 
## 4.2 不同点
![因子分析法8](./因子分析法8.png)
![因子分析法9](./因子分析法9.png)
![因子分析法10](./因子分析法10.png)